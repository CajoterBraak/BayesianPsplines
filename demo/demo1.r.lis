
R version 3.2.0 (2015-04-16) -- "Full of Ingredients"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # INLA for P-splines
> # Predict
> 
> # Simulate data
> n =  50
> set.seed(2013)
> x = seq(0, 1, length = n)
> y0 = sin(14 * x)
> sd = 0.1
> y = y0 + rnorm(n) * sd
> 
> library(INLA)
Loading required package: sp
Loading required package: Matrix
Loading required package: splines
> library(BayesianPsplines)
> mydata = data.frame(y = y, x= x)
> hyperGumbel = list(prec = list(prior="pc.prec", param=c(U=1/0.31,alpha=0.01)))
> rs = smooth_inla(mydata, hyperB=hyperGumbel)
Note: method with signature 'CsparseMatrix#Matrix#missing#replValue' chosen for function '[<-',
 target signature 'dgCMatrix#lgeMatrix#missing#numeric'.
 "Matrix#ldenseMatrix#missing#replValue" would also be valid
y ~ -1 + f(idx0, model = "iid", hyper = hyper.fixed, constr = FALSE) + 
    f(idx1, model = "generic", Cmatrix = basisP[[1]]$P, constr = TRUE, 
        hyper = hyperB[[1]], diagonal = 1e-04)
<environment: 0x0000000013489f90>
Note: method with signature 'TsparseMatrix#Matrix#missing#replValue' chosen for function '[<-',
 target signature 'dgTMatrix#ngCMatrix#missing#numeric'.
 "Matrix#nsparseMatrix#missing#replValue" would also be valid
> summary(rs$model) # rs$model is the inla object

Call:
c("inla(formula = formula.P, family = family, data = datalist, quantiles = quantiles, ",  "    offset = offset, verbose = verbose, lincomb = lc.grid, control.compute = contr.comp, ",  "    control.predictor = list(A = A.matrix, compute = TRUE, link = NULL), ",  "    control.family = list(hyper = list(prec = prior.observation.precision)))" )

Time used:
 Pre-processing    Running inla Post-processing           Total 
         0.6881          0.5131          0.4360          1.6372 

The model has no fixed effects

Linear combinations (derived):
       ID    mean     sd 0.05quant 0.5quant 0.95quant    mode kld
lc001   1  0.0605 0.1717   -0.2229   0.0613    0.3406  0.0629   0
lc002   2 -1.6219 0.9269   -3.1581  -1.6136   -0.1158 -1.5983   0
lc003   3 -1.4196 0.7784   -2.7097  -1.4126   -0.1541 -1.3999   0
lc004   4 -1.2172 0.6396   -2.2771  -1.2118   -0.1768 -1.2016   0
lc005   5 -1.0150 0.5128   -1.8645  -1.0110   -0.1799 -1.0034   0
lc006   6 -0.8130 0.4005   -1.4759  -0.8102   -0.1598 -0.8050   0
lc007   7 -0.6112 0.3038   -1.1135  -0.6096   -0.1146 -0.6064   0
lc008   8 -0.4103 0.2220   -0.7765  -0.4095   -0.0466 -0.4081   0
lc009   9 -0.2127 0.1540   -0.4662  -0.2126    0.0404 -0.2124   0
lc010  10 -0.0215 0.1021   -0.1890  -0.0218    0.1469 -0.0223   0
lc011  11  0.1604 0.0715    0.0432   0.1602    0.2782  0.1598   0
lc012  12  0.3300 0.0618    0.2284   0.3300    0.4316  0.3300   0
lc013  13  0.4848 0.0595    0.3869   0.4848    0.5827  0.4849   0
lc014  14  0.6231 0.0573    0.5288   0.6231    0.7173  0.6232   0
lc015  15  0.7434 0.0563    0.6508   0.7435    0.8360  0.7435   0
lc016  16  0.8443 0.0576    0.7496   0.8443    0.9391  0.8443   0
lc017  17  0.9244 0.0583    0.8285   0.9243    1.0202  0.9243   0
lc018  18  0.9817 0.0556    0.8902   0.9818    1.0732  0.9818   0
lc019  19  1.0139 0.0529    0.9268   1.0140    1.1007  1.0142   0
lc020  20  1.0182 0.0536    0.9298   1.0184    1.1060  1.0187   0
lc021  21  0.9920 0.0568    0.8982   0.9922    1.0852  0.9925   0
lc022  22  0.9325 0.0581    0.8367   0.9327    1.0279  0.9330   0
lc023  23  0.8398 0.0554    0.7484   0.8399    0.9306  0.8402   0
lc024  24  0.7192 0.0526    0.6326   0.7193    0.8055  0.7196   0
lc025  25  0.5773 0.0534    0.4894   0.5773    0.6650  0.5773   0
lc026  26  0.4202 0.0567    0.3271   0.4201    0.5135  0.4200   0
lc027  27  0.2543 0.0578    0.1593   0.2542    0.3495  0.2540   0
lc028  28  0.0848 0.0551   -0.0056   0.0847    0.1756  0.0845   0
lc029  29 -0.0852 0.0525   -0.1714  -0.0853    0.0013 -0.0855   0
lc030  30 -0.2529 0.0535   -0.3409  -0.2529   -0.1648 -0.2530   0
lc031  31 -0.4154 0.0568   -0.5088  -0.4154   -0.3221 -0.4154   0
lc032  32 -0.5701 0.0577   -0.6650  -0.5700   -0.4753 -0.5699   0
lc033  33 -0.7135 0.0548   -0.8038  -0.7134   -0.6234 -0.7133   0
lc034  34 -0.8417 0.0524   -0.9281  -0.8416   -0.7556 -0.8415   0
lc035  35 -0.9508 0.0537   -1.0391  -0.9507   -0.8626 -0.9507   0
lc036  36 -1.0366 0.0569   -1.1302  -1.0366   -0.9430 -1.0367   0
lc037  37 -1.0952 0.0576   -1.1899  -1.0953   -1.0003 -1.0954   0
lc038  38 -1.1236 0.0548   -1.2135  -1.1238   -1.0333 -1.1241   0
lc039  39 -1.1205 0.0528   -1.2068  -1.1208   -1.0333 -1.1213   0
lc040  40 -1.0847 0.0544   -1.1736  -1.0849   -0.9948 -1.0855   0
lc041  41 -1.0148 0.0576   -1.1092  -1.0150   -0.9198 -1.0154   0
lc042  42 -0.9099 0.0578   -1.0048  -0.9101   -0.8145 -0.9104   0
lc043  43 -0.7729 0.0546   -0.8624  -0.7730   -0.6830 -0.7732   0
lc044  44 -0.6121 0.0524   -0.6982  -0.6121   -0.5261 -0.6121   0
lc045  45 -0.4363 0.0541   -0.5255  -0.4362   -0.3475 -0.4359   0
lc046  46 -0.2541 0.0575   -0.3489  -0.2539   -0.1598 -0.2536   0
lc047  47 -0.0740 0.0577   -0.1692  -0.0739    0.0206 -0.0736   0
lc048  48  0.0987 0.0545    0.0089   0.0988    0.1880  0.0991   0
lc049  49  0.2630 0.0524    0.1768   0.2630    0.3490  0.2631   0
lc050  50  0.4180 0.0542    0.3290   0.4179    0.5072  0.4178   0
lc051  51  0.5626 0.0575    0.4683   0.5625    0.6573  0.5624   0
lc052  52  0.6960 0.0575    0.6017   0.6960    0.7907  0.6958   0
lc053  53  0.8149 0.0542    0.7259   0.8148    0.9041  0.8147   0
lc054  54  0.9134 0.0524    0.8273   0.9135    0.9995  0.9136   0
lc055  55  0.9861 0.0545    0.8963   0.9863    1.0754  0.9866   0
lc056  56  1.0272 0.0578    0.9318   1.0274    1.1220  1.0277   0
lc057  57  1.0312 0.0577    0.9360   1.0314    1.1257  1.0318   0
lc058  58  0.9981 0.0544    0.9084   0.9984    1.0871  0.9988   0
lc059  59  0.9326 0.0525    0.8460   0.9328    1.0186  0.9331   0
lc060  60  0.8393 0.0545    0.7497   0.8394    0.9288  0.8395   0
lc061  61  0.7232 0.0575    0.6286   0.7232    0.8178  0.7231   0
lc062  62  0.5888 0.0571    0.4950   0.5888    0.6828  0.5887   0
lc063  63  0.4403 0.0539    0.3519   0.4402    0.5291  0.4401   0
lc064  64  0.2811 0.0524    0.1950   0.2810    0.3674  0.2809   0
lc065  65  0.1146 0.0546    0.0248   0.1146    0.2044  0.1145   0
lc066  66 -0.0558 0.0576   -0.1505  -0.0558    0.0389 -0.0558   0
lc067  67 -0.2265 0.0569   -0.3202  -0.2265   -0.1330 -0.2264   0
lc068  68 -0.3935 0.0537   -0.4819  -0.3934   -0.3053 -0.3933   0
lc069  69 -0.5520 0.0524   -0.6383  -0.5520   -0.4659 -0.5519   0
lc070  70 -0.6976 0.0548   -0.7877  -0.6975   -0.6075 -0.6975   0
lc071  71 -0.8255 0.0577   -0.9203  -0.8255   -0.7307 -0.8255   0
lc072  72 -0.9313 0.0568   -1.0246  -0.9314   -0.8379 -0.9314   0
lc073  73 -1.0115 0.0536   -1.0994  -1.0116   -0.9232 -1.0117   0
lc074  74 -1.0630 0.0526   -1.1492  -1.0631   -0.9762 -1.0634   0
lc075  75 -1.0829 0.0552   -1.1734  -1.0831   -0.9919 -1.0834   0
lc076  76 -1.0683 0.0580   -1.1634  -1.0685   -0.9727 -1.0687   0
lc077  77 -1.0168 0.0569   -1.1101  -1.0170   -0.9228 -1.0173   0
lc078  78 -0.9308 0.0537   -1.0188  -0.9311   -0.8421 -0.9315   0
lc079  79 -0.8154 0.0528   -0.9019  -0.8157   -0.7283 -0.8161   0
lc080  80 -0.6757 0.0553   -0.7664  -0.6758   -0.5845 -0.6760   0
lc081  81 -0.5165 0.0578   -0.6116  -0.5166   -0.4213 -0.5167   0
lc082  82 -0.3432 0.0565   -0.4362  -0.3432   -0.2503 -0.3431   0
lc083  83 -0.1621 0.0535   -0.2503  -0.1620   -0.0744 -0.1618   0
lc084  84  0.0197 0.0532   -0.0681   0.0199    0.1066  0.0203   0
lc085  85  0.1952 0.0561    0.1025   0.1955    0.2871  0.1959   0
lc086  86  0.3575 0.0588    0.2604   0.3577    0.4538  0.3582   0
lc087  87  0.5006 0.0580    0.4048   0.5009    0.5956  0.5014   0
lc088  88  0.6255 0.0565    0.5323   0.6257    0.7181  0.6261   0
lc089  89  0.7359 0.0573    0.6415   0.7359    0.8300  0.7360   0
lc090  90  0.8352 0.0595    0.7374   0.8352    0.9331  0.8352   0
lc091  91  0.9272 0.0619    0.8257   0.9271    1.0291  0.9269   0
lc092  92  1.0151 0.0715    0.8980   1.0149    1.1332  1.0144   0
lc093  93  1.1004 0.1018    0.9332   1.1002    1.2680  1.1000   0
lc094  94  1.1836 0.1531    0.9318   1.1836    1.4355  1.1835   0
lc095  95  1.2655 0.2205    0.9029   1.2655    1.6282  1.2654   0
lc096  96  1.3469 0.3019    0.8507   1.3467    1.8435  1.3464   0
lc097  97  1.4282 0.3981    0.7744   1.4279    2.0832  1.4272   0
lc098  98  1.5097 0.5101    0.6726   1.5091    2.3490  1.5080   0
lc099  99  1.5913 0.6366    0.5471   1.5904    2.6387  1.5888   0
lc100 100  1.6730 0.7752    0.4020   1.6717    2.9483  1.6695   0
lc101 101  1.7547 0.9234    0.2412   1.7530    3.2738  1.7502   0
lc102 102  0.0249 0.0923   -0.1263   0.0246    0.1772  0.0241   0
lc103 103  0.3192 0.0620    0.2172   0.3192    0.4212  0.3192   0
lc104 104  0.5722 0.0581    0.4766   0.5723    0.6678  0.5723   0
lc105 105  0.7759 0.0565    0.6829   0.7759    0.8688  0.7760   0
lc106 106  0.9233 0.0583    0.8274   0.9233    1.0192  0.9233   0
lc107 107  1.0062 0.0535    0.9180   1.0063    1.0941  1.0064   0
lc108 108  1.0126 0.0547    0.9224   1.0128    1.1022  1.0131   0
lc109 109  0.9298 0.0581    0.8340   0.9299    1.0251  0.9302   0
lc110 110  0.7555 0.0531    0.6679   0.7556    0.8426  0.7559   0
lc111 111  0.5154 0.0547    0.4256   0.5154    0.6053  0.5153   0
lc112 112  0.2397 0.0577    0.1449   0.2396    0.3347  0.2394   0
lc113 113 -0.0463 0.0528   -0.1330  -0.0464    0.0408 -0.0466   0
lc114 114 -0.3275 0.0550   -0.4179  -0.3275   -0.2371 -0.3275   0
lc115 115 -0.5906 0.0574   -0.6851  -0.5905   -0.4962 -0.5904   0
lc116 116 -0.8201 0.0526   -0.9068  -0.8200   -0.7337 -0.8199   0
lc117 117 -0.9973 0.0553   -1.0883  -0.9973   -0.9063 -0.9973   0
lc118 118 -1.1029 0.0573   -1.1970  -1.1030   -1.0086 -1.1031   0
lc119 119 -1.1227 0.0528   -1.2092  -1.1230   -1.0354 -1.1235   0
lc120 120 -1.0501 0.0562   -1.1422  -1.0503   -0.9572 -1.0508   0
lc121 121 -0.8797 0.0572   -0.9736  -0.8799   -0.7853 -0.8801   0
lc122 122 -0.6251 0.0524   -0.7112  -0.6251   -0.5389 -0.6251   0
lc123 123 -0.3259 0.0563   -0.4187  -0.3257   -0.2336 -0.3254   0
lc124 124 -0.0230 0.0570   -0.1169  -0.0228    0.0704 -0.0225   0
lc125 125  0.2589 0.0524    0.1727   0.2590    0.3449  0.2591   0
lc126 126  0.5144 0.0565    0.4217   0.5143    0.6075  0.5141   0
lc127 127  0.7386 0.0565    0.6458   0.7385    0.8316  0.7383   0
lc128 128  0.9156 0.0524    0.8295   0.9157    1.0017  0.9158   0
lc129 129  1.0188 0.0570    0.9248   1.0190    1.1123  1.0193   0
lc130 130  1.0224 0.0565    0.9291   1.0226    1.1149  1.0230   0
lc131 131  0.9264 0.0525    0.8397   0.9265    1.0125  0.9268   0
lc132 132  0.7529 0.0570    0.6592   0.7529    0.8465  0.7528   0
lc133 133  0.5245 0.0557    0.4329   0.5244    0.6162  0.5243   0
lc134 134  0.2602 0.0525    0.1740   0.2601    0.3466  0.2600   0
lc135 135 -0.0235 0.0572   -0.1176  -0.0235    0.0706 -0.0235   0
lc136 136 -0.3099 0.0554   -0.4010  -0.3099   -0.2190 -0.3098   0
lc137 137 -0.5791 0.0526   -0.6657  -0.5791   -0.4927 -0.5790   0
lc138 138 -0.8091 0.0574   -0.9035  -0.8091   -0.7147 -0.8091   0
lc139 139 -0.9784 0.0550   -1.0688  -0.9785   -0.8879 -0.9786   0
lc140 140 -1.0704 0.0529   -1.1572  -1.0706   -0.9831 -1.0709   0
lc141 141 -1.0710 0.0579   -1.1659  -1.0712   -0.9756 -1.0715   0
lc142 142 -0.9693 0.0550   -1.0593  -0.9695   -0.8786 -0.9699   0
lc143 143 -0.7785 0.0532   -0.8657  -0.7787   -0.6906 -0.7790   0
lc144 144 -0.5225 0.0578   -0.6175  -0.5225   -0.4273 -0.5226   0
lc145 145 -0.2263 0.0545   -0.3160  -0.2262   -0.1369 -0.2261   0
lc146 146  0.0789 0.0539   -0.0101   0.0792    0.1671  0.0796   0
lc147 147  0.3598 0.0588    0.2627   0.3601    0.4562  0.3606   0
lc148 148  0.5896 0.0568    0.4959   0.5898    0.6826  0.5903   0
lc149 149  0.7750 0.0581    0.6794   0.7750    0.8705  0.7750   0
lc150 150  0.9331 0.0621    0.8312   0.9330    1.0355  0.9328   0
lc151 151  1.0793 0.0921    0.9282   1.0791    1.2310  1.0788   0

Random effects:
Name	  Model
 idx0   IID model 
idx1   Generic0 model 

Model hyperparameters:
                                          mean      sd 0.05quant 0.5quant
Precision for the Gaussian observations 89.741 21.1887    58.644   87.798
Precision for idx1                       2.514  0.9467     1.241    2.375
                                        0.95quant   mode
Precision for the Gaussian observations   127.627 84.270
Precision for idx1                          4.268  2.108

Expected number of effective parameters(std dev): 14.46(0.8279)
Number of equivalent replicates : 3.457 

Deviance Information Criterion (DIC) ...: -66.35
Effective number of parameters .........: 15.53

Marginal log-Likelihood:  -0.3031 
Posterior marginals for linear predictor and fitted values computed

> pred = component_plus_residual(rs)
> names(pred$pred.grid)# predicted values for gridpoints
[1] "x_grid"    "mean"      "sd"        "0.05quant" "0.5quant"  "0.95quant"
> names(pred$pred.data) # predicted values for data
 [1] "x"             "y"             "observed.tr"   "yhat"         
 [5] "residual"      "componentplus" "mean"          "sd"           
 [9] "X0.05quant"    "X0.5quant"     "X0.95quant"    "mode"         
[13] "kld"          
> 
> 
> proc.time()
   user  system elapsed 
   2.26    0.54    3.74 
